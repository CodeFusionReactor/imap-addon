<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        caption="msg://editorCaption"
        class="com.haulmont.addon.imap.web.imapmailbox.ImapMailBoxEdit"
        datasource="mailBoxDs"
        focusComponent="mainParams"
        messagesPack="com.haulmont.addon.imap.web.imapmailbox">
    <dsContext>
        <datasource id="mailBoxDs"
                    class="com.haulmont.addon.imap.entity.ImapMailBox"
                    view="imap-mailbox-edit">
            <datasource id="authenticationDs"
                        property="authentication"/>
            <datasource id="proxyDs"
                        property="proxy"/>
            <hierarchicalDatasource id="foldersDs"
                                    property="folders"
                                    hierarchyProperty="parent">
                <collectionDatasource id="eventsDs"
                                      property="events"/>
            </hierarchicalDatasource>
        </datasource>
    </dsContext>
    <layout expand="foldersPane"
            spacing="true">
            <hbox spacing="true">
                <groupBox caption="msg://connectionConfigurationCaption"
                          spacing="true"
                          width="AUTO">
                    <fieldGroup id="mainParams"
                                datasource="mailBoxDs">
                        <column width="250px">
                            <field property="host"/>
                            <field property="port"/>
                            <field property="secureMode"/>
                            <field id="mailBoxRootCertificateField"
                                   property="rootCertificate"/>
                            <field datasource="authenticationDs"
                                   property="username"/>
                            <field id="authenticationPasswordId">
                                <passwordField caption="msg://passwordFieldCaption"
                                               datasource="authenticationDs"
                                               maxLength="128"
                                               property="password"
                                               required="true"/>
                            </field>
                            <field id="useProxyChkBoxField">
                                <checkBox id="useProxyChkBox"
                                          caption="msg://useProxyCaption"/>
                            </field>

                        </column>
                    </fieldGroup>
                    <button caption="msg://checkConnectionCaption"
                            invoke="checkTheConnection"/>
                </groupBox>
                <vbox spacing="true">
                    <groupBox caption="msg://pollingConfigurationCaption"
                              spacing="true"
                              width="AUTO">
                        <fieldGroup id="pollingParams"
                                    datasource="mailBoxDs">
                            <column width="250px">
                                <field property="pollInterval"/>
                                <field property="processingTimeout"/>
                                <field property="cubaFlag"/>
                                <field property="updateSliceSize"/>
                                <field id="useTrashFolderChkBoxField">
                                    <checkBox id="useTrashFolderChkBox"
                                              caption="msg://useTrashFolderForRemovalCaption"/>
                                </field>
                                <field id="trashFolderNameField"
                                       editable="false"
                                       property="trashFolderName"/>
                            </column>
                        </fieldGroup>
                        <button id="selectTrashFolderButton"
                                caption="msg://selectTrashFolderCaption"
                                invoke="selectTrashFolder"/>
                    </groupBox>
                    <groupBox caption="msg://proxyConfigurationCaption"
                              spacing="true"
                              width="AUTO">
                        <fieldGroup id="proxyParams"
                                    datasource="proxyDs">
                            <column width="250px">
                                <field datasource="proxyDs" property="host" caption="msg://proxyHostCaption" id="proxyHostField"/>
                                <field datasource="proxyDs" property="port" caption="msg://proxyPortCaption" id="proxyPortField"/>
                                <field datasource="proxyDs" property="webProxy" caption="msg://proxyUseWebCaption" id="webProxyChkBox"/>
                            </column>
                        </fieldGroup>
                    </groupBox>
                </vbox>
            </hbox>
            <hbox id="foldersPane" margin="false,true,true,true" width="100%">
                <split id="foldersSplit" width="100%" height="100%" orientation="horizontal" pos="70">
                    <vbox id="tablePane" height="100%" margin="false;true;false;false">
                        <treeTable id="foldersTable"
                                   editable="true"
                                   height="100%"
                                   sortable="false"
                                   width="100%">
                            <columns>
                                <column id="name" editable="false"/>
                                <column id="selected" editable="true" caption="" width="5px"/>
                                <column id="eventsInfo" editable="false" caption="Events" />
                            </columns>
                            <rows datasource="foldersDs"/>
                        </treeTable>
                    </vbox>

                    <vbox margin="false;false;false;true" height="100%">
                        <groupBox width="100%" height="100%" caption="msg://eventsCaption">
                            <vbox id="selectedFolderPanel" width="100%" height="100%" expand="editEventsContainer"
                                  visible="false">
                                <scrollBox id="editEventsContainer" width="100%">
                                    <grid id="editEventsGrid" width="100%" margin="true">
                                        <columns count="2"/>
                                        <rows>
                                            <row>
                                                <label value="msg://allEvents"/>
                                                <checkBox id="allEventsChkBox" align="MIDDLE_CENTER"/>
                                            </row>
                                        </rows>
                                    </grid>
                                </scrollBox>
                            </vbox>
                        </groupBox>
                    </vbox>
                </split>
            </hbox>
        <frame id="windowActions"
               screen="editWindowActions"/>
    </layout>
</window>
